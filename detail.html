<!DOCTYPE html>
<html lang="zh-TW">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>é è³¼è©³ç´°åå–®</title>

<style>
body {
Â  Â  font-family: Arial;
Â  Â  background: #0d0d0d;
Â  Â  color: white;
Â  Â  padding: 25px;
}

.glass {
Â  Â  backdrop-filter: blur(14px);
Â  Â  background: rgba(255,255,255,0.12);
Â  Â  border-radius: 18px;
Â  Â  padding: 20px;
Â  Â  border: 1px solid rgba(255,255,255,0.25);
Â  Â  box-shadow: 0 4px 30px rgba(0,0,0,0.3);
}

table {
Â  Â  width: 100%;
Â  Â  margin-top: 20px;
Â  Â  border-collapse: collapse;
}

th, td {
Â  Â  padding: 10px 12px;
Â  Â  border-bottom: 1px solid rgba(255,255,255,0.25);
}

th {
Â  Â  cursor: pointer;
Â  Â  color: #ffe98a;
}

tr:hover {
Â  Â  background: rgba(255,255,255,0.15);
}

#search-box {
Â  Â  width: 100%;
Â  Â  padding: 12px;
Â  Â  border-radius: 12px;
Â  Â  border: 1px solid rgba(255,255,255,0.3);
Â  Â  background: rgba(255,255,255,0.1);
Â  Â  color: white;
Â  Â  margin-top: 10px;
}

.floating-btn {
Â  Â  position: fixed;
Â  Â  right: 25px;
Â  Â  bottom: 25px;
Â  Â  background: rgba(255,255,255,0.25);
Â  Â  backdrop-filter: blur(10px);
Â  Â  border-radius: 22px;
Â  Â  padding: 20px 32px;
Â  Â  font-size: 18px;
Â  Â  cursor: pointer;
Â  Â  border: 1px solid rgba(255,255,255,0.4);
Â  Â  box-shadow: 0 0 12px rgba(255,255,255,0.25);
}
</style>
</head>

<body>
<h1>806 åœ’éŠæœƒé è³¼è©³ç´°åå–®</h1>

<div class="glass">
Â  Â  <input id="search-box" placeholder="æœå°‹å§“å / å–®ä½ / é¤é» / å‚™è¨»" />
Â  Â Â 
Â  Â  <table id="data-table">
Â  Â  Â  Â  <thead>
Â  Â  Â  Â  Â  Â  <tr>
Â  Â  Â  Â  Â  Â  Â  Â  <th data-col="0">é‹é€ä½ç½® â¬</th>
Â  Â  Â  Â  Â  Â  Â  Â  <th data-col="1">å§“å â¬</th>
Â  Â  Â  Â  Â  Â  Â  Â  <th data-col="2">é¤é» â¬</th>
Â  Â  Â  Â  Â  Â  Â  Â  <th data-col="3">ä»½æ•¸ â¬</th>
Â  Â  Â  Â  Â  Â  Â  Â  <th data-col="4">é‡‘é¡ â¬</th>
Â  Â  Â  Â  Â  Â  Â  Â  <th data-col="5">æ”¶æ¬¾ â¬</th>
Â  Â  Â  Â  Â  Â  Â  Â  <th data-col="6">å‚™è¨» â¬</th>
Â  Â  Â  Â  Â  Â  </tr>
Â  Â  Â  Â  </thead>
Â  Â  Â  Â  <tbody id="table-body">
Â  Â  Â  Â  Â  Â  <tr><td colspan="7">è³‡æ–™è®€å–ä¸­...</td></tr>
Â  Â  Â  Â  </tbody>
Â  Â  </table>
</div>

<div class="floating-btn" onclick="window.location.href='index.html'">
Â  Â  å›åˆ°ç¸½è¦½ â‡¦
</div>

<script>
// Google Sheet JSON API
const apiURL =
Â  "https://docs.google.com/spreadsheets/d/1lmsxOD90L1oNa7XMoM1c5jzwZ05mpxUfiCBIa_DBpkA/gviz/tq?gid=0&tqx=out:json";

let tableData = [];
let sortState = { col: null, asc: true };

// --- æŠ“è³‡æ–™ ---
function fetchDetailData() {
Â  Â  fetch(apiURL)
Â  Â  Â  Â  .then(res => res.text()) // ğŸŒŸ ä¿®æ­£: ä»¥ç´”æ–‡å­—è®€å– JSONP
Â  Â  Â  Â  .then(txt => {
Â  Â  Â  Â  Â  Â  // ğŸŒŸ ä¿®æ­£: æå– JSONP å…§éƒ¨çš„ç´” JSON å­—ä¸²
Â  Â  Â  Â  Â  Â  const jsonStart = txt.indexOf("{");
Â  Â  Â  Â  Â  Â  const jsonEnd = txt.lastIndexOf("}") + 1;
Â  Â  Â  Â  Â  Â  const jsonText = txt.substring(jsonStart, jsonEnd);
Â  Â  Â  Â  Â  Â  
Â  Â  Â  Â  Â  Â  if (!jsonText) throw new Error("ç„¡æ³•è§£æ Google Sheets è³‡æ–™");
Â  Â  Â  Â  Â  Â  
Â  Â  Â  Â  Â  Â  const data = JSON.parse(jsonText);

Â  Â  Â  Â  Â  Â  // ä½¿ç”¨ index.html ä¸­æˆåŠŸçš„çµæ§‹ (å‡è¨­ 'é è³¼' æ˜¯è³‡æ–™é™£åˆ—çš„ key)
Â  Â  Â  Â  Â  Â  const rows = data.é è³¼ || []; 

Â  Â  Â  Â  Â  Â  tableData = rows
Â  Â  Â  Â  Â  Â  Â  Â  .map(r => {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  // æ¬„ä½åç¨±æ‡‰èˆ‡ Google Sheet ä¸­çš„æ¨™é¡Œå®Œå…¨ä¸€è‡´
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  return [
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  r["é‹é€ä½ç½®"] ?? "",Â 
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  r["å§“å"] ?? "",Â 
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  r["é¤é»"] ?? "",Â 
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  r["ä»½æ•¸"] ?? "",Â 
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  r["é‡‘é¡"] ?? "",Â 
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  r["æ”¶æ¬¾"] ?? "",Â 
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  r["å‚™è¨»"] ?? ""Â 
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  ];
Â  Â  Â  Â  Â  Â  Â  Â  })
Â  Â  Â  Â  Â  Â  Â  Â  .filter(row => row.some(v => v !== "")); // éæ¿¾ç©ºåˆ—

Â  Â  Â  Â  Â  Â  renderTable(tableData);
Â  Â  Â  Â  })
Â  Â  Â  Â  .catch(err => {
Â  Â  Â  Â  Â  Â  console.error("è®€å– Google Sheets å¤±æ•—:", err);
Â  Â  Â  Â  Â  Â  document.getElementById("table-body").innerHTML =
Â  Â  Â  Â  Â  Â  Â  Â  `<tr><td colspan="7">è®€å–å¤±æ•—</td></tr>`;
Â  Â  Â  Â  });
}

// --- æ¸²æŸ“è¡¨æ ¼ ---
function renderTable(data) {
Â  Â  let html = "";
Â  Â  data.forEach(row => {
Â  Â  Â  Â  html += "<tr>";
Â  Â  Â  Â  row.forEach(cell => html += `<td>${cell}</td>`);
Â  Â  Â  Â  html += "</tr>";
Â  Â  });
Â  Â  document.getElementById("table-body").innerHTML = html;
}

// --- æœå°‹ ---
document.getElementById("search-box").addEventListener("input", function () {
Â  Â  const keyword = this.value.toLowerCase();
Â  Â  const filtered = tableData.filter(row =>
Â  Â  Â  Â  row.some(cell => String(cell).toLowerCase().includes(keyword))
Â  Â  );
Â  Â  renderTable(filtered);
});

// --- æ’åº ---
document.querySelectorAll("th").forEach(th => {
Â  Â  th.addEventListener("click", () => {
Â  Â  Â  Â  // ç¢ºä¿æ¬„ä½ç´¢å¼•ç‚ºæ•¸å­—
Â  Â  Â  Â  const col = Number(th.dataset.col);

Â  Â  Â  Â  if (sortState.col === col) {
Â  Â  Â  Â  Â  Â  sortState.asc = !sortState.asc;
Â  Â  Â  Â  } else {
Â  Â  Â  Â  Â  Â  sortState.col = col;
Â  Â  Â  Â  Â  Â  sortState.asc = true;
Â  Â  Â  Â  }

Â  Â  Â  Â  tableData.sort((a, b) => {
Â  Â  Â  Â  Â  Â  let x = a[col];
Â  Â  Â  Â  Â  Â  let y = b[col];

Â  Â  Â  Â  Â  Â  const numX = Number(x);
Â  Â  Â  Â  Â  Â  const numY = Number(y);
Â  Â  Â  Â  Â  Â  // ç¢ºä¿åªå°éç©ºä¸”æœ‰æ•ˆçš„æ•¸å­—é€²è¡Œæ•¸å­—æ’åº
Â  Â  Â  Â  Â  Â  const isNumber = !isNaN(numX) && !isNaN(numY) && x !== "" && y !== ""; 

Â  Â  Â  Â  Â  Â  if (isNumber) {
Â  Â  Â  Â  Â  Â  Â  Â  x = numX;
Â  Â  Â  Â  Â  Â  Â  Â  y = numY;
Â  Â  Â  Â  Â  Â  } else {
Â  Â  Â  Â  Â  Â  Â  Â  x = String(x);
Â  Â  Â  Â  Â  Â  Â  Â  y = String(y);
Â  Â  Â  Â  Â  Â  }

Â  Â  Â  Â  Â  Â  return sortState.asc ? (x > y ? 1 : -1) : (x < y ? 1 : -1);
Â  Â  Â  Â  });

Â  Â  Â  Â  renderTable(tableData);
Â  Â  });
});

// åˆå§‹åŒ–
fetchDetailData();
</script>

</body>
</html>
